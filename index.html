<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>MyKala PRO++ - Ù¾Ø±Ø¯Ø§Ø®Øª Ø¢Ù†Ù„Ø§ÛŒÙ†</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Tahoma,sans-serif;}
body{background:#f5f6f8;direction:rtl;color:#333;}
header{background:#ef394e;color:#fff;padding:12px 15px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;}
header strong{font-size:24px;cursor:pointer;}
header input{flex:1;min-width:180px;padding:8px 12px;border:none;border-radius:8px;margin:5px;}
header span{cursor:pointer;margin:0 5px;}
.badge{background:#fff;color:#ef394e;border-radius:50%;padding:2px 6px;font-size:12px;margin-left:4px;}
.slider{position:relative;width:100%;overflow:hidden;border-radius:12px;margin:15px 0;}
.slider img{width:100%;height:300px;object-fit:cover;transition:0.5s;}
.container{padding:15px;}
.filter-panel{background:#fff;padding:15px;border-radius:12px;box-shadow:0 6px 15px rgba(0,0,0,0.1);margin-bottom:15px;display:flex;flex-wrap:wrap;gap:10px;}
.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px;}
.card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,0.1);transition:0.3s;display:flex;flex-direction:column;}
.card:hover{transform:translateY(-5px);box-shadow:0 12px 20px rgba(0,0,0,0.15);}
.card img{height:160px;object-fit:contain;background:#f9f9f9;}
.card h4{font-size:14px;margin:10px 0;flex:1;padding:0 5px;}
.price{color:#ef394e;font-weight:bold;padding:0 5px;}
button{background:#ef394e;border:none;color:#fff;padding:8px;border-radius:6px;cursor:pointer;margin:5px;transition:0.3s;}
button:hover{background:#d32f2f;}
.page{display:none;}
.page.active{display:block;}
.cart-item{background:#fff;padding:10px;border-radius:8px;margin-bottom:10px;display:flex;justify-content:space-between;flex-wrap:wrap;box-shadow:0 3px 8px rgba(0,0,0,0.08);}
footer{background:#333;color:#fff;text-align:center;padding:12px;margin-top:20px;}
input, select, textarea{margin:5px 0;padding:8px;border-radius:6px;border:1px solid #ccc;width:100%;}
textarea{resize:none;}
.admin-panel,.user-panel,.order-panel{background:#fff;padding:20px;border-radius:12px;box-shadow:0 6px 15px rgba(0,0,0,0.1);max-width:700px;margin:20px auto;}
.admin-panel h3,.user-panel h3,.order-panel h3{margin-bottom:15px;color:#ef394e;}
.admin-panel h4,.user-panel h4,.order-panel h4{margin:12px 0 8px 0;color:#333;}
.order-summary{background:#f9f9f9;padding:10px;border-radius:8px;margin-bottom:10px;}
</style>
</head>
<body>

<header>
  <strong onclick="showPage('home')">MyKala</strong>
  <input id="search" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ù…Ø­ØµÙˆÙ„Ø§Øª...">
  <span onclick="showPage('cartUser')">ğŸ›’ <span class="badge" id="cartCount">0</span></span>
  <span onclick="showPage('login')">ÙˆØ±ÙˆØ¯</span>
</header>

<div class="slider">
  <img id="slide" src="https://picsum.photos/1200/300?1">
</div>

<div class="container">

<div class="filter-panel">
  <select id="categoryFilter">
    <option value="">Ù‡Ù…Ù‡ Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§</option>
    <option value="Ù…ÙˆØ¨Ø§ÛŒÙ„">Ù…ÙˆØ¨Ø§ÛŒÙ„</option>
    <option value="Ù„Ù¾â€ŒØªØ§Ù¾">Ù„Ù¾â€ŒØªØ§Ù¾</option>
    <option value="Ù‡Ø¯ÙÙˆÙ†">Ù‡Ø¯ÙÙˆÙ†</option>
    <option value="Ø³Ø§Ø¹Øª">Ø³Ø§Ø¹Øª</option>
    <option value="ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ†">ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ†</option>
  </select>
  <input type="number" id="minPrice" placeholder="Ø­Ø¯Ø§Ù‚Ù„ Ù‚ÛŒÙ…Øª">
  <input type="number" id="maxPrice" placeholder="Ø­Ø¯Ø§Ú©Ø«Ø± Ù‚ÛŒÙ…Øª">
  <select id="sortOrder">
    <option value="">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ</option>
    <option value="priceAsc">Ù‚ÛŒÙ…Øª Ú©Ù…â†’Ø²ÛŒØ§Ø¯</option>
    <option value="priceDesc">Ù‚ÛŒÙ…Øª Ø²ÛŒØ§Ø¯â†’Ú©Ù…</option>
    <option value="nameAsc">Ù†Ø§Ù… Ø§Ù„Ùâ†’ÛŒ</option>
    <option value="nameDesc">Ù†Ø§Ù… ÛŒâ†’Ø§Ù„Ù</option>
  </select>
  <button onclick="applyFilter()">Ø§Ø¹Ù…Ø§Ù„ ÙÛŒÙ„ØªØ±</button>
</div>

<!-- HOME -->
<div id="home" class="page active">
  <div class="products" id="productList"></div>
</div>

<!-- LOGIN -->
<div id="login" class="page">
  <h3>ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</h3>
  <input id="loginUser" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ Ø§ÛŒÙ…ÛŒÙ„"><br>
  <input id="loginPass" type="password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±"><br>
  <button onclick="login()">ÙˆØ±ÙˆØ¯</button>
</div>

<!-- USER PANEL -->
<div id="user" class="page">
  <div class="user-panel">
    <h3>Ù¾Ù†Ù„ Ú©Ø§Ø±Ø¨Ø±ÛŒ</h3>
    <h4>Ù…Ø­ØµÙˆÙ„Ø§Øª</h4>
    <div class="products" id="userProductList"></div>
  </div>
</div>

<!-- USER CART & ORDER -->
<div id="cartUser" class="page">
  <h3>Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§</h3>
  <div id="cartItemsUser"></div>
  <h4 id="totalPriceUser"></h4>
  <div class="order-panel">
    <h3>Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´</h3>
    <input id="orderName" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ">
    <input id="orderPhone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³">
    <textarea id="orderAddress" placeholder="Ø¢Ø¯Ø±Ø³ Ú©Ø§Ù…Ù„"></textarea>
    <select id="orderPayment">
      <option value="online">Ù¾Ø±Ø¯Ø§Ø®Øª Ø¢Ù†Ù„Ø§ÛŒÙ†</option>
      <option value="cod">Ù¾Ø±Ø¯Ø§Ø®Øª Ø¯Ø± Ù…Ø­Ù„</option>
    </select>
    <button onclick="placeOrder()">Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´</button>
  </div>
</div>

<!-- ADMIN PANEL -->
<div id="admin" class="page">
  <div class="admin-panel">
    <h3>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h3>
    <h4>Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯</h4>
    <input id="adminName" placeholder="Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„">
    <input id="adminPrice" placeholder="Ù‚ÛŒÙ…Øª">
    <input id="adminImg" placeholder="Ù„ÛŒÙ†Ú© Ø¹Ú©Ø³">
    <input id="adminCategory" placeholder="Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ">
    <button onclick="addProduct()">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„</button>
    <h4>Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…ÙˆØ¬ÙˆØ¯</h4>
    <div id="adminProducts"></div>
    <h4>Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ø«Ø¨Øª Ø´Ø¯Ù‡</h4>
    <div id="adminOrders"></div>
  </div>
</div>

</div>

<footer>Â© 2025 MyKala PRO++</footer>

<!-- jsPDF CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
const { jsPDF } = window.jspdf;

/* SLIDER */
const slides=["https://picsum.photos/1200/300?1","https://picsum.photos/1200/300?2","https://picsum.photos/1200/300?3"];
let si=0;
setInterval(()=>{document.getElementById("slide").src=slides[si];si=(si+1)%slides.length;},3500);

/* USERS */
const users=[
  {email:"user1@test.com", password:"1234", name:"Ú©Ø§Ø±Ø¨Ø± Û±"},
  {email:"user2@test.com", password:"abcd", name:"Ú©Ø§Ø±Ø¨Ø± Û²"}
];

/* ADMIN */
const adminUserName="admin";
const adminPassword="1234";

/* PRODUCTS */
let products=[
 {id:1,name:"Ú¯ÙˆØ´ÛŒ Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯ A54",price:12000000,img:"https://picsum.photos/200?1",category:"Ù…ÙˆØ¨Ø§ÛŒÙ„"},
 {id:2,name:"Ù„Ù¾â€ŒØªØ§Ù¾ Ù„Ù†ÙˆÙˆ",price:35000000,img:"https://picsum.photos/200?2",category:"Ù„Ù¾â€ŒØªØ§Ù¾"},
 {id:3,name:"Ù‡Ø¯ÙÙˆÙ† Ø¨Ù„ÙˆØªÙˆØ«",price:1500000,img:"https://picsum.photos/200?3",category:"Ù‡Ø¯ÙÙˆÙ†"},
 {id:4,name:"ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† 55 Ø§ÛŒÙ†Ú†",price:28000000,img:"https://picsum.photos/200?4",category:"ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ†"},
 {id:5,name:"Ø³Ø§Ø¹Øª Ù‡ÙˆØ´Ù…Ù†Ø¯",price:4200000,img:"https://picsum.photos/200?5",category:"Ø³Ø§Ø¹Øª"}
];

/* ORDERS */
let orders=JSON.parse(localStorage.getItem("orders"))||[];

/* RENDER PRODUCTS */
const productList=document.getElementById("productList");
const userProductList=document.getElementById("userProductList");
const search=document.getElementById("search");

function renderProducts(list,container){
 container.innerHTML="";
 list.forEach(p=>{
  container.innerHTML+=`
   <div class="card">
    <img src="${p.img}">
    <h4>${p.name}</h4>
    <div class="price">${p.price.toLocaleString()} ØªÙˆÙ…Ø§Ù†</div>
    <button onclick="addToCartUser(${p.id})">Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯</button>
   </div>
  `;
 });
}
renderProducts(products,productList);
renderProducts(products,userProductList);

/* FILTER + SEARCH + SORT */
function applyFilter(){
 let filtered=[...products];
 const category=document.getElementById("categoryFilter").value;
 const min=parseInt(document.getElementById("minPrice").value);
 const max=parseInt(document.getElementById("maxPrice").value);
 const sort=document.getElementById("sortOrder").value;
 const query=search.value.trim();

 if(category) filtered=filtered.filter(p=>p.category===category);
 if(!isNaN(min)) filtered=filtered.filter(p=>p.price>=min);
 if(!isNaN(max)) filtered=filtered.filter(p=>p.price<=max);
 if(query) filtered=filtered.filter(p=>p.name.includes(query));

 switch(sort){
   case "priceAsc": filtered.sort((a,b)=>a.price-b.price); break;
   case "priceDesc": filtered.sort((a,b)=>b.price-a.price); break;
   case "nameAsc": filtered.sort((a,b)=>a.name.localeCompare(b.name)); break;
   case "nameDesc": filtered.sort((a,b)=>b.name.localeCompare(a.name)); break;
 }

 renderProducts(filtered,productList);
 renderProducts(filtered,userProductList);
}

search.addEventListener("input",applyFilter);
document.getElementById("categoryFilter").addEventListener("change",applyFilter);
document.getElementById("minPrice").addEventListener("input",applyFilter);
document.getElementById("maxPrice").addEventListener("input",applyFilter);
document.getElementById("sortOrder").addEventListener("change",applyFilter);

/* CART USER */
function getCartUser(){return JSON.parse(localStorage.getItem("cartUser"))||[];}
function saveCartUser(c){localStorage.setItem("cartUser",JSON.stringify(c));updateCartCountUser();}
function addToCartUser(id){const cart=getCartUser();cart.push(products.find(p=>p.id===id));saveCartUser(cart);alert("Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯");}
function removeFromCartUser(i){const cart=getCartUser();cart.splice(i,1);saveCartUser(cart);loadCartUser();}
function loadCartUser(){const cart=getCartUser();const div=document.getElementById("cartItemsUser");let total=0;div.innerHTML="";cart.forEach((p,i)=>{total+=p.price;div.innerHTML+=`<div class="cart-item"><span>${p.name}</span><span>${p.price.toLocaleString()} <button onclick="removeFromCartUser(${i})">âŒ</button></span></div>`;});document.getElementById("totalPriceUser").innerText="Ø¬Ù…Ø¹ Ú©Ù„: "+total.toLocaleString()+" ØªÙˆÙ…Ø§Ù†";}
function updateCartCountUser(){document.getElementById("cartCount").innerText=getCartUser().length;}
updateCartCountUser();

/* PLACE ORDER + PDF */
function placeOrder(){
 const name=document.getElementById("orderName").value.trim();
 const phone=document.getElementById("orderPhone").value.trim();
 const address=document.getElementById("orderAddress").value.trim();
 const payment=document.getElementById("orderPayment").value;
 const cart=getCartUser();
 if(!name||!phone||!address||cart.length===0){alert("ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ùˆ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø¨Ø§ÛŒØ¯ Ù¾Ø± Ø´ÙˆØ¯");return;}

 // Ù¾Ø±Ø¯Ø§Ø®Øª Ø¢Ù†Ù„Ø§ÛŒÙ† Ø´Ø¨ÛŒÙ‡ Ø³Ø§Ø²ÛŒ
 if(payment==="online"){
   if(!confirm("Ù¾Ø±Ø¯Ø§Ø®Øª Ø¢Ù†Ù„Ø§ÛŒÙ† Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯. ØªØ§ÛŒÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯ØŸ")) return;
 }

 const order={id:Date.now(),name,phone,address,payment,items:cart};
 orders.push(order);
 localStorage.setItem("orders",JSON.stringify(orders));

 alert("Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø«Ø¨Øª Ø´Ø¯! Ø§Ú©Ù†ÙˆÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ÙØ§Ú©ØªÙˆØ± PDF Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯.");
 generatePDF(order);

 localStorage.removeItem("cartUser");
 updateCartCountUser();
 document.getElementById("orderName").value="";
 document.getElementById("orderPhone").value="";
 document.getElementById("orderAddress").value="";
 loadCartUser();
 renderAdmin();
}

/* GENERATE PDF */
function generatePDF(order){
 const doc = new jsPDF();
 doc.setFontSize(18);
 doc.text("ÙØ§Ú©ØªÙˆØ± Ø®Ø±ÛŒØ¯ MyKala",105,20,null,null,"center");
 doc.setFontSize(12);
 doc.text(`Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ: ${order.name}`,20,40);
 doc.text(`Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³: ${order.phone}`,20,50);
 doc.text(`Ø¢Ø¯Ø±Ø³: ${order.address}`,20,60);
 doc.text(`Ø±ÙˆØ´ Ù¾Ø±Ø¯Ø§Ø®Øª: ${order.payment}`,20,70);
 let y=80;
 order.items.forEach((it,i)=>{
   doc.text(`${i+1}. ${it.name} - ${it.price.toLocaleString()} ØªÙˆÙ…Ø§Ù†`,20,y);
   y+=10;
 });
 const total=order.items.reduce((a,b)=>a+b.price,0);
 doc.text(`Ø¬Ù…Ø¹ Ú©Ù„: ${total.toLocaleString()} ØªÙˆÙ…Ø§Ù†`,20,y+10);
 doc.save(`MyKala_Invoice_${order.id}.pdf`);
}

/* PAGES */
function showPage(id){
 document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
 document.getElementById(id).classList.add("active");
 if(id==="cartUser") loadCartUser();
 if(id==="admin") renderAdmin();
 if(id==="user") renderProducts(products,userProductList);
}

/* LOGIN */
function login(){
 const user=document.getElementById("loginUser").value.trim();
 const pass=document.getElementById("loginPass").value.trim();
 if(user===adminUserName && pass===adminPassword){
   alert("ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ± Ù…ÙˆÙÙ‚!");
   showPage("admin");
 } else {
   const u=users.find(x=>x.email===user && x.password===pass);
   if(u){
     alert("ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ù…ÙˆÙÙ‚!");
     showPage("user");
   } else {
     alert("Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!");
   }
 }
}

/* ADMIN PANEL */
function renderAdmin(){
 const adminProducts=document.getElementById("adminProducts");
 adminProducts.innerHTML="";
 products.forEach((p,i)=>{
   adminProducts.innerHTML+=`
     <div class="card" style="margin-bottom:5px;">
       <strong>${p.name}</strong> - ${p.price.toLocaleString()} ØªÙˆÙ…Ø§Ù† - Ø¯Ø³ØªÙ‡: ${p.category}
       <button onclick="editProduct(${i})">ÙˆÛŒØ±Ø§ÛŒØ´</button>
       <button onclick="deleteProduct(${i})">Ø­Ø°Ù</button>
     </div>`;
 });

 const adminOrders=document.getElementById("adminOrders");
 adminOrders.innerHTML="";
 orders.forEach(o=>{
   let items=o.items.map(it=>it.name+" ("+it.price.toLocaleString()+" ØªÙˆÙ…Ø§Ù†)").join(", ");
   adminOrders.innerHTML+=`<div class="order-summary"><strong>${o.name}</strong> - ${o.phone}<br>Ø¢Ø¯Ø±Ø³: ${o.address}<br>Ù¾Ø±Ø¯Ø§Ø®Øª: ${o.payment}<br>Ù…Ø­ØµÙˆÙ„Ø§Øª: ${items}</div>`;
 });
}

function addProduct(){
 const name=document.getElementById("adminName").value.trim();
 const price=parseInt(document.getElementById("adminPrice").value);
 const img=document.getElementById("adminImg").value.trim();
 const category=document.getElementById("adminCategory").value.trim();
 if(!name||!price||!img||!category){alert("Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯");return;}
 products.push({id:Date.now(),name,price,img,category});
 renderProducts(products,productList);
 renderProducts(products,userProductList);
 renderAdmin();
 document.getElementById("adminName").value="";
 document.getElementById("adminPrice").value="";
 document.getElementById("adminImg").value="";
 document.getElementById("adminCategory").value="";
}

function deleteProduct(i){products.splice(i,1);renderProducts(products,productList);renderProducts(products,userProductList);renderAdmin();}
function editProduct(i){
